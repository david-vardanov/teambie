<% layout('layouts/boilerplate') %>

<h1>Edit Event</h1>

<form action="/events/<%= event.id %>?_method=PUT" method="POST" class="form">
    <div class="form-group">
        <label for="employeeId">Employee</label>
        <select name="employeeId" id="employeeId" required>
            <% employees.forEach(emp => { %>
                <option value="<%= emp.id %>" <%= emp.id === event.employeeId ? 'selected' : '' %>><%= emp.name %></option>
            <% }) %>
        </select>
    </div>

    <div class="form-group">
        <label for="type">Event Type</label>
        <select name="type" id="type" required>
            <option value="VACATION" <%= event.type === 'VACATION' ? 'selected' : '' %>>Vacation</option>
            <option value="HOLIDAY" <%= event.type === 'HOLIDAY' ? 'selected' : '' %>>Holiday</option>
            <option value="SICK_DAY" <%= event.type === 'SICK_DAY' ? 'selected' : '' %>>Sick Day</option>
            <option value="HOME_OFFICE" <%= event.type === 'HOME_OFFICE' ? 'selected' : '' %>>Home Office</option>
            <option value="LATE_LEFT_EARLY" <%= event.type === 'LATE_LEFT_EARLY' ? 'selected' : '' %>>Late/Left Early</option>
            <option value="DAY_OFF_PAID" <%= event.type === 'DAY_OFF_PAID' ? 'selected' : '' %>>Day Off Paid</option>
            <option value="DAY_OFF_UNPAID" <%= event.type === 'DAY_OFF_UNPAID' ? 'selected' : '' %>>Day Off Unpaid</option>
            <% if (event.type === 'START_WORKING') { %>
            <option value="START_WORKING" selected>Start Working</option>
            <% } %>
            <option value="PROBATION_FINISHED" <%= event.type === 'PROBATION_FINISHED' ? 'selected' : '' %>>Probation Finished</option>
            <option value="LAST_DAY" <%= event.type === 'LAST_DAY' ? 'selected' : '' %>>Last Day</option>
        </select>
    </div>

    <div class="form-group">
        <label for="startDate">Start Date</label>
        <input type="date" name="startDate" id="startDate" value="<%= event.startDate.toISOString().split('T')[0] %>" required>
    </div>

    <div class="form-group">
        <label for="endDate">End Date (optional)</label>
        <input type="date" name="endDate" id="endDate" value="<%= event.endDate ? event.endDate.toISOString().split('T')[0] : '' %>">
        <small>Leave empty for single-day events</small>
    </div>

    <div class="form-group">
        <label for="notes">Notes</label>
        <textarea name="notes" id="notes" rows="3"><%= event.notes || '' %></textarea>
    </div>

    <div class="form-actions">
        <button type="submit" class="btn btn-primary">Update Event</button>
        <a href="/events/calendar" class="btn btn-secondary">Cancel</a>
    </div>
</form>

<form action="/events/<%= event.id %>?_method=DELETE" method="POST" style="margin-top: 20px;">
    <button type="submit" class="btn btn-danger" onclick="return confirm('Are you sure you want to delete this event?')">Delete Event</button>
</form>
